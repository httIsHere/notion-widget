<!DOCTYPE html>
<html lang="zh-CN">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>孟菲斯风闪卡学习</title>
<style>
  body {
    font-family: 'Segoe UI', sans-serif;
    background: #f9f9f9;
    margin: 0;
    padding: 0;
    overflow-x: hidden;
  }

  header {
    background: linear-gradient(45deg,#ff6b6b,#feca57,#48dbfb,#1dd1a1);
    background-size: 400% 400%;
    animation: gradient 12s ease infinite;
    padding: 1.5rem;
    text-align: center;
    color: #fff;
    position: relative;
  }
  @keyframes gradient {
    0% {background-position:0% 50%;}
    50% {background-position:100% 50%;}
    100% {background-position:0% 50%;}
  }

  h1 {
    margin: 0;
    font-size: 2rem;
    letter-spacing: 2px;
  }

  .upload-area {
    margin: 1rem auto;
    text-align: center;
  }
  input[type="file"] {
    margin-top: .5rem;
  }

  .container {
    display: flex;
    justify-content: space-around;
    flex-wrap: wrap;
    padding: 1rem;
  }

  /* Flashcard */
  .flashcard {
    width: 300px;
    height: 200px;
    perspective: 1000px;
    margin: 1rem;
    cursor: pointer;
    position: relative;
  }
  .flashcard-inner {
    position: relative;
    width: 100%;
    height: 100%;
    text-align: center;
    transition: transform 0.8s;
    transform-style: preserve-3d;
  }
  .flashcard.flipped .flashcard-inner {
    transform: rotateY(180deg);
  }
  .flashcard-front, .flashcard-back {
    position: absolute;
    width: 100%;
    height: 100%;
    backface-visibility: hidden;
    border-radius: 16px;
    display: flex;
    justify-content: center;
    align-items: center;
    font-size: 1.5rem;
    color: #333;
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
  }
  .flashcard-front {
    background: #ff9ff3;
  }
  .flashcard-back {
    background: #feca57;
    transform: rotateY(180deg);
  }

  .controls {
    text-align: center;
    margin-top: 1rem;
  }
  button {
    background: #54a0ff;
    border: none;
    color: #fff;
    padding: .6rem 1.2rem;
    margin: 0 .5rem;
    border-radius: 8px;
    font-size: 1rem;
    cursor: pointer;
    transition: background 0.3s;
  }
  button:hover {
    background: #2e86de;
  }

  /* Stats */
  .stats {
    min-width: 220px;
    background: #1dd1a1;
    color: #fff;
    padding: 1rem;
    border-radius: 12px;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
    margin: 1rem;
  }
  .stats h3 {
    margin-top: 0;
  }

  /* 孟菲斯风装饰 */
  .pattern {
    position: fixed;
    pointer-events: none;
    z-index: -1;
  }
  .circle {
    width: 80px; height: 80px;
    border-radius: 50%;
    background: rgba(255,0,150,0.2);
    top: 20%; left: 10%;
  }
  .triangle {
    width: 0; height: 0;
    border-left: 50px solid transparent;
    border-right: 50px solid transparent;
    border-bottom: 80px solid rgba(0,255,200,0.2);
    top: 60%; right: 15%;
  }
</style>
</head>
<body>
  <header>
    <h1>孟菲斯风闪卡学习</h1>
  </header>

  <div class="upload-area">
    <label>上传CSV单词库（格式：单词,释义）</label><br>
    <input type="file" id="fileInput" accept=".csv" />
    <button id="startBtn">开始学习</button>
  </div>

  <div class="container">
    <div class="flashcard" id="flashcard">
      <div class="flashcard-inner">
        <div class="flashcard-front" id="cardFront">请先上传并开始</div>
        <div class="flashcard-back" id="cardBack"></div>
      </div>
    </div>
    <div class="stats">
      <h3>学习统计</h3>
      <p>已学习：<span id="studied">0</span></p>
      <p>认识：<span id="known">0</span></p>
      <p>不认识：<span id="unknown">0</span></p>
      <p>剩余：<span id="remaining">0</span></p>
    </div>
  </div>

  <div class="controls">
    <button id="knownBtn">认识</button>
    <button id="unknownBtn">不认识</button>
    <button id="nextBtn">下一个</button>
  </div>

  <!-- 装饰 -->
  <div class="pattern circle"></div>
  <div class="pattern triangle"></div>

<script>
  let words = []; // [{word,meaning}]
  let currentIndex = -1;
  let studied = 0, known = 0, unknown = 0;

  const fileInput = document.getElementById('fileInput');
  const startBtn = document.getElementById('startBtn');
  const flashcard = document.getElementById('flashcard');
  const cardFront = document.getElementById('cardFront');
  const cardBack = document.getElementById('cardBack');
  const knownBtn = document.getElementById('knownBtn');
  const unknownBtn = document.getElementById('unknownBtn');
  const nextBtn = document.getElementById('nextBtn');

  const studiedSpan = document.getElementById('studied');
  const knownSpan = document.getElementById('known');
  const unknownSpan = document.getElementById('unknown');
  const remainingSpan = document.getElementById('remaining');

  flashcard.addEventListener('click', () => {
    flashcard.classList.toggle('flipped');
  });

  startBtn.addEventListener('click', () => {
    if (!fileInput.files.length) {
      alert('请先选择一个CSV文件');
      return;
    }
    const file = fileInput.files[0];
    const reader = new FileReader();
    reader.onload = function(e) {
      const lines = e.target.result.split(/\r?\n/).filter(l=>l.trim()!=='');
      words = lines.map(line => {
        const [w, m] = line.split(',');
        return { word: w?.trim() || '', meaning: m?.trim() || '' };
      });
      if (words.length === 0) {
        alert('文件内容为空或格式不正确');
        return;
      }
      resetStats();
      nextWord();
    };
    reader.readAsText(file);
  });

  knownBtn.addEventListener('click', () => {
    if (currentIndex >= 0) {
      known++;
      studied++;
      updateStats();
      nextWord();
    }
  });

  unknownBtn.addEventListener('click', () => {
    if (currentIndex >= 0) {
      unknown++;
      studied++;
      updateStats();
      nextWord();
    }
  });

  nextBtn.addEventListener('click', () => {
    nextWord();
  });

  function nextWord() {
    if (words.length === 0) {
      cardFront.textContent = '已完成所有单词！';
      cardBack.textContent = '';
      return;
    }
    currentIndex = Math.floor(Math.random() * words.length);
    const {word, meaning} = words[currentIndex];
    cardFront.textContent = word;
    cardBack.textContent = meaning;
    flashcard.classList.remove('flipped');
    // 移除已显示单词，确保不重复
    words.splice(currentIndex, 1);
    updateStats();
  }

  function updateStats() {
    studiedSpan.textContent = studied;
    knownSpan.textContent = known;
    unknownSpan.textContent = unknown;
    remainingSpan.textContent = words.length;
  }

  function resetStats() {
    studied = 0;
    known = 0;
    unknown = 0;
    updateStats();
  }
</script>
</body>
</html>
